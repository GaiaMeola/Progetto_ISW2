========== METHOD #1000 ==========
Method: ../bookkeeper/hedwig-client/src/main/java/org/apache/hedwig/client/netty/HedwigClientImpl.java/getPublisher
Release: 4.0.0

Code:
public HedwigPublisher getPublisher() {
    return pub;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #2000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java/newLedgerPath
Release: 4.0.0

Code:
/**
 * Create a new zk ledger path.
 *
 * @param cb
 *        Callback when getting new zk ledger path to create.
 */
public abstract void newLedgerPath(GenericCallback<String> cb);

METRICS:
LOC: 7
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 1
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #3000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/meta/TopicPersistenceManager 2.java/writeTopicPersistenceInfo
Release: 4.0.0

Code:
/**
 * Update persistence info of a specified topic.
 *
 * @param topic
 *          Topic name
 * @param ranges
 *          Persistence info
 * @param version
 *          Current version of persistence info.
 *          If <code>version</code> is {@link Version.NEW}, create persistence info;
 *          {@link PubSubException.TopicPersistenceInfoExistsException} is returned when
 *          persistence info existed before.
 *          Otherwise, the persitence info is updated only when
 *          provided version equals to its current version.
 *          {@link PubSubException.BadVersionException} is returned when version doesn't match,
 *          {@link PubSubException.NoTopicPersistenceInfoException} is returned when no
 *          persistence info found to update.
 * @param callback
 *          Callback when persistence info updated. New version would be returned.
 * @param ctx
 *          Context of the callback
 */
public void writeTopicPersistenceInfo(ByteString topic, LedgerRanges ranges, Version version, Callback<Version> callback, Object ctx);

METRICS:
LOC: 23
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 5
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #4000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/hasSynchronous
Release: 4.1.0

Code:
public boolean hasSynchronous() {
    return hasSynchronous;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #5000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServerMXBean 2.java/getReadStats
Release: 4.1.0

Code:
/**
 * @return read stats
 */
public OpStatData getReadStats();

METRICS:
LOC: 4
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #6000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadata.java/resolveConflict
Release: 4.1.0

Code:
/**
 * Resolve conflict with new updated metadata.
 *
 * @param newMeta
 *          Re-read metadata
 * @return true if the conflict has been resolved, otherwise false.
 */
boolean resolveConflict(LedgerMetadata newMeta) {
    /*
         *  if length & close have changed, then another client has
         *  opened the ledger, can't resolve this conflict.
         */
    if (metadataFormatVersion != newMeta.metadataFormatVersion || ensembleSize != newMeta.ensembleSize || quorumSize != newMeta.quorumSize || length != newMeta.length || close != newMeta.close) {
        return false;
    }
    // new meta znode version should be larger than old one
    if (znodeVersion > newMeta.znodeVersion) {
        return false;
    }
    // ensemble size should be same
    if (ensembles.size() != newMeta.ensembles.size()) {
        return false;
    }
    // ensemble distribution should be same
    // we don't check the detail ensemble, since new bookie will be set
    // using recovery tool.
    Iterator<Long> keyIter = ensembles.keySet().iterator();
    Iterator<Long> newMetaKeyIter = newMeta.ensembles.keySet().iterator();
    for (int i = 0; i < ensembles.size(); i++) {
        Long curKey = keyIter.next();
        Long newMetaKey = newMetaKeyIter.next();
        if (!curKey.equals(newMetaKey)) {
            return false;
        }
    }
    /*
         *  if the conflict has been resolved, then update
         *  ensemble and znode version
         */
    ensembles = newMeta.ensembles;
    znodeVersion = newMeta.znodeVersion;
    return true;
}

METRICS:
LOC: 32
Cyclomatic Complexity: 6
Cognitive Complexity: 6
Parameter Count: 1
Nesting Depth: 2
Smells: 1
Smell types:
  - CyclomaticComplexity


========== METHOD #7000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/meta/FactoryLayout 2.java/getManagerMeta
Release: 4.1.0

Code:
public ManagerMeta getManagerMeta() {
    return managerMeta;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #8000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/getHeaderOrBuilder
Release: 4.2.0

Code:
org.apache.hedwig.protocol.PubSubProtocol.MessageHeaderOrBuilder getHeaderOrBuilder();

METRICS:
LOC: 1
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #9000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/getDescriptor
Release: 4.2.0

Code:
public static final com.google.protobuf.Descriptors.Descriptor getDescriptor() {
    return org.apache.hedwig.protocol.PubSubProtocol.internal_static_Hedwig_SubscriptionEventResponse_descriptor;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #10000 ==========
Method: ../bookkeeper/hedwig-client/src/main/java/org/apache/hedwig/client/netty/impl/multiplex/MultiplexHChannelManager 2.java/storeSubscriptionChannel
Release: 4.2.0

Code:
protected Either<Boolean, HChannel> storeSubscriptionChannel(TopicSubscriber topicSubscriber, PubSubData txn, HChannel channel) {
    boolean replaced = sub2Channels.replaceChannel(topicSubscriber, txn.getOriginalChannelForResubscribe(), channel);
    if (replaced) {
        return Either.of(replaced, channel);
    } else {
        return Either.of(replaced, null);
    }
}

METRICS:
LOC: 6
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 3
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #11000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ResponseBuilder 3.java/buildReadResponse
Release: 4.2.0

Code:
static BookieProtocol.Response buildReadResponse(ByteBuffer data, BookieProtocol.Request r) {
    return new BookieProtocol.ReadResponse(r.getProtocolVersion(), BookieProtocol.EOK, r.getLedgerId(), r.getEntryId(), ChannelBuffers.wrappedBuffer(data));
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 2
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #12000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor 2.java/process
Release: 4.2.0

Code:
@Override
public void process(WatchedEvent event) {
    // listen children changed event from ZooKeeper
    if (event.getState() == KeeperState.Disconnected || event.getState() == KeeperState.Expired) {
        submitShutdownTask();
    } else if (event.getType() == EventType.NodeChildrenChanged) {
        submitAuditTask();
    }
}

METRICS:
LOC: 6
Cyclomatic Complexity: 3
Cognitive Complexity: 3
Parameter Count: 1
Nesting Depth: 2
Smells: 0
Smell types:


========== METHOD #13000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerCacheImpl.java/getNumOpenLedgers
Release: 4.2.0

Code:
@Override
public int getNumOpenLedgers() {
    return openLedgers.size();
}

METRICS:
LOC: 3
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #14000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/common/TopicOpQueuer.java/run
Release: 4.2.0

Code:
@Override
public final void run() {
    runInternal();
    popAndRunNext(topic);
}

METRICS:
LOC: 4
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #15000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/getRemoteComponentsCount
Release: 4.2.1

Code:
int getRemoteComponentsCount();

METRICS:
LOC: 1
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #16000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/setStatusMsg
Release: 4.2.1

Code:
void setStatusMsg(com.google.protobuf.ByteString value) {
    bitField0_ |= 0x00000008;
    statusMsg_ = value;
    onChanged();
}

METRICS:
LOC: 4
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 1
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #17000 ==========
Method: ../bookkeeper/hedwig-client-jms/src/main/java/org/apache/hedwig/jms/message/TextMessageImpl.java/reset
Release: 4.2.1

Code:
@Override
public void reset() throws JMSException {
    if (this.readMode)
        return;
    this.readMode = true;
}

METRICS:
LOC: 5
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 0
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #18000 ==========
Method: ../bookkeeper/hedwig-client/src/main/java/org/apache/hedwig/client/api/Subscriber.java/asyncCloseSubscription
Release: 4.2.1

Code:
/**
 * Closes all of the client side cached data for this subscription without
 * actually sending an unsubscribe request to the server. This will close
 * the subscribe channel asynchronously (if it exists) for the topic.
 *
 * @param topic
 *            Topic name of the subscription
 * @param subscriberId
 *            ID of the subscriber
 * @param callback
 *            Callback to invoke when the subscribe channel has been closed.
 * @param context
 *            Calling context that the Callback needs since this is done
 *            asynchronously.
 */
public void asyncCloseSubscription(ByteString topic, ByteString subscriberId, Callback<Void> callback, Object context);

METRICS:
LOC: 16
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 4
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #19000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DataFormats 2.java/hasPassword
Release: 4.2.1

Code:
public boolean hasPassword() {
    return ((bitField0_ & 0x00000080) == 0x00000080);
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 1
Smell types:
  - MissingOverride


========== METHOD #20000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java/getHeardFromBitSet
Release: 4.2.1

Code:
private BitSet getHeardFromBitSet(Set<InetSocketAddress> heardFromHosts) {
    BitSet b = new BitSet(ensemble.size());
    for (InetSocketAddress i : heardFromHosts) {
        int index = ensemble.indexOf(i);
        if (index != -1) {
            b.set(index);
        }
    }
    return b;
}

METRICS:
LOC: 7
Cyclomatic Complexity: 3
Cognitive Complexity: 3
Parameter Count: 1
Nesting Depth: 2
Smells: 0
Smell types:


========== METHOD #21000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogger.java/diskFull
Release: 4.2.1

Code:
@Override
public void diskFull(File disk) {
    // If the current entry log disk is full, then create new entry
    // log.
    if (currentDir != null && currentDir.equals(disk)) {
        shouldCreateNewEntryLog.set(true);
    }
}

METRICS:
LOC: 4
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 1
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #22000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/persistence/CacheKey.java/getSeqId
Release: 4.2.1

Code:
public long getSeqId() {
    return seqId;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #1000 ==========
Method: ../bookkeeper/hedwig-client/src/main/java/org/apache/hedwig/client/netty/HedwigClientImpl.java/getPublisher
Release: 4.0.0

Code:
public HedwigPublisher getPublisher() {
    return pub;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #2000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java/newLedgerPath
Release: 4.0.0

Code:
/**
 * Create a new zk ledger path.
 *
 * @param cb
 *        Callback when getting new zk ledger path to create.
 */
public abstract void newLedgerPath(GenericCallback<String> cb);

METRICS:
LOC: 7
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 1
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #3000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/meta/TopicPersistenceManager 2.java/writeTopicPersistenceInfo
Release: 4.0.0

Code:
/**
 * Update persistence info of a specified topic.
 *
 * @param topic
 *          Topic name
 * @param ranges
 *          Persistence info
 * @param version
 *          Current version of persistence info.
 *          If <code>version</code> is {@link Version.NEW}, create persistence info;
 *          {@link PubSubException.TopicPersistenceInfoExistsException} is returned when
 *          persistence info existed before.
 *          Otherwise, the persitence info is updated only when
 *          provided version equals to its current version.
 *          {@link PubSubException.BadVersionException} is returned when version doesn't match,
 *          {@link PubSubException.NoTopicPersistenceInfoException} is returned when no
 *          persistence info found to update.
 * @param callback
 *          Callback when persistence info updated. New version would be returned.
 * @param ctx
 *          Context of the callback
 */
public void writeTopicPersistenceInfo(ByteString topic, LedgerRanges ranges, Version version, Callback<Version> callback, Object ctx);

METRICS:
LOC: 23
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 5
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #4000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/hasSynchronous
Release: 4.1.0

Code:
public boolean hasSynchronous() {
    return hasSynchronous;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #5000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServerMXBean 2.java/getReadStats
Release: 4.1.0

Code:
/**
 * @return read stats
 */
public OpStatData getReadStats();

METRICS:
LOC: 4
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #6000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadata.java/resolveConflict
Release: 4.1.0

Code:
/**
 * Resolve conflict with new updated metadata.
 *
 * @param newMeta
 *          Re-read metadata
 * @return true if the conflict has been resolved, otherwise false.
 */
boolean resolveConflict(LedgerMetadata newMeta) {
    /*
         *  if length & close have changed, then another client has
         *  opened the ledger, can't resolve this conflict.
         */
    if (metadataFormatVersion != newMeta.metadataFormatVersion || ensembleSize != newMeta.ensembleSize || quorumSize != newMeta.quorumSize || length != newMeta.length || close != newMeta.close) {
        return false;
    }
    // new meta znode version should be larger than old one
    if (znodeVersion > newMeta.znodeVersion) {
        return false;
    }
    // ensemble size should be same
    if (ensembles.size() != newMeta.ensembles.size()) {
        return false;
    }
    // ensemble distribution should be same
    // we don't check the detail ensemble, since new bookie will be set
    // using recovery tool.
    Iterator<Long> keyIter = ensembles.keySet().iterator();
    Iterator<Long> newMetaKeyIter = newMeta.ensembles.keySet().iterator();
    for (int i = 0; i < ensembles.size(); i++) {
        Long curKey = keyIter.next();
        Long newMetaKey = newMetaKeyIter.next();
        if (!curKey.equals(newMetaKey)) {
            return false;
        }
    }
    /*
         *  if the conflict has been resolved, then update
         *  ensemble and znode version
         */
    ensembles = newMeta.ensembles;
    znodeVersion = newMeta.znodeVersion;
    return true;
}

METRICS:
LOC: 32
Cyclomatic Complexity: 6
Cognitive Complexity: 6
Parameter Count: 1
Nesting Depth: 2
Smells: 1
Smell types:
  - CyclomaticComplexity


========== METHOD #7000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/meta/FactoryLayout 2.java/getManagerMeta
Release: 4.1.0

Code:
public ManagerMeta getManagerMeta() {
    return managerMeta;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #8000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/getHeaderOrBuilder
Release: 4.2.0

Code:
org.apache.hedwig.protocol.PubSubProtocol.MessageHeaderOrBuilder getHeaderOrBuilder();

METRICS:
LOC: 1
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #9000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/getDescriptor
Release: 4.2.0

Code:
public static final com.google.protobuf.Descriptors.Descriptor getDescriptor() {
    return org.apache.hedwig.protocol.PubSubProtocol.internal_static_Hedwig_SubscriptionEventResponse_descriptor;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #10000 ==========
Method: ../bookkeeper/hedwig-client/src/main/java/org/apache/hedwig/client/netty/impl/multiplex/MultiplexHChannelManager 2.java/storeSubscriptionChannel
Release: 4.2.0

Code:
protected Either<Boolean, HChannel> storeSubscriptionChannel(TopicSubscriber topicSubscriber, PubSubData txn, HChannel channel) {
    boolean replaced = sub2Channels.replaceChannel(topicSubscriber, txn.getOriginalChannelForResubscribe(), channel);
    if (replaced) {
        return Either.of(replaced, channel);
    } else {
        return Either.of(replaced, null);
    }
}

METRICS:
LOC: 6
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 3
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #11000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ResponseBuilder 3.java/buildReadResponse
Release: 4.2.0

Code:
static BookieProtocol.Response buildReadResponse(ByteBuffer data, BookieProtocol.Request r) {
    return new BookieProtocol.ReadResponse(r.getProtocolVersion(), BookieProtocol.EOK, r.getLedgerId(), r.getEntryId(), ChannelBuffers.wrappedBuffer(data));
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 2
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #12000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor 2.java/process
Release: 4.2.0

Code:
@Override
public void process(WatchedEvent event) {
    // listen children changed event from ZooKeeper
    if (event.getState() == KeeperState.Disconnected || event.getState() == KeeperState.Expired) {
        submitShutdownTask();
    } else if (event.getType() == EventType.NodeChildrenChanged) {
        submitAuditTask();
    }
}

METRICS:
LOC: 6
Cyclomatic Complexity: 3
Cognitive Complexity: 3
Parameter Count: 1
Nesting Depth: 2
Smells: 0
Smell types:


========== METHOD #13000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerCacheImpl.java/getNumOpenLedgers
Release: 4.2.0

Code:
@Override
public int getNumOpenLedgers() {
    return openLedgers.size();
}

METRICS:
LOC: 3
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #14000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/common/TopicOpQueuer.java/run
Release: 4.2.0

Code:
@Override
public final void run() {
    runInternal();
    popAndRunNext(topic);
}

METRICS:
LOC: 4
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #15000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/getRemoteComponentsCount
Release: 4.2.1

Code:
int getRemoteComponentsCount();

METRICS:
LOC: 1
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #16000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/setStatusMsg
Release: 4.2.1

Code:
void setStatusMsg(com.google.protobuf.ByteString value) {
    bitField0_ |= 0x00000008;
    statusMsg_ = value;
    onChanged();
}

METRICS:
LOC: 4
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 1
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #17000 ==========
Method: ../bookkeeper/hedwig-client-jms/src/main/java/org/apache/hedwig/jms/message/TextMessageImpl.java/reset
Release: 4.2.1

Code:
@Override
public void reset() throws JMSException {
    if (this.readMode)
        return;
    this.readMode = true;
}

METRICS:
LOC: 5
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 0
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #18000 ==========
Method: ../bookkeeper/hedwig-client/src/main/java/org/apache/hedwig/client/api/Subscriber.java/asyncCloseSubscription
Release: 4.2.1

Code:
/**
 * Closes all of the client side cached data for this subscription without
 * actually sending an unsubscribe request to the server. This will close
 * the subscribe channel asynchronously (if it exists) for the topic.
 *
 * @param topic
 *            Topic name of the subscription
 * @param subscriberId
 *            ID of the subscriber
 * @param callback
 *            Callback to invoke when the subscribe channel has been closed.
 * @param context
 *            Calling context that the Callback needs since this is done
 *            asynchronously.
 */
public void asyncCloseSubscription(ByteString topic, ByteString subscriberId, Callback<Void> callback, Object context);

METRICS:
LOC: 16
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 4
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #19000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DataFormats 2.java/hasPassword
Release: 4.2.1

Code:
public boolean hasPassword() {
    return ((bitField0_ & 0x00000080) == 0x00000080);
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 1
Smell types:
  - MissingOverride


========== METHOD #20000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java/getHeardFromBitSet
Release: 4.2.1

Code:
private BitSet getHeardFromBitSet(Set<InetSocketAddress> heardFromHosts) {
    BitSet b = new BitSet(ensemble.size());
    for (InetSocketAddress i : heardFromHosts) {
        int index = ensemble.indexOf(i);
        if (index != -1) {
            b.set(index);
        }
    }
    return b;
}

METRICS:
LOC: 7
Cyclomatic Complexity: 3
Cognitive Complexity: 3
Parameter Count: 1
Nesting Depth: 2
Smells: 0
Smell types:


========== METHOD #21000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogger.java/diskFull
Release: 4.2.1

Code:
@Override
public void diskFull(File disk) {
    // If the current entry log disk is full, then create new entry
    // log.
    if (currentDir != null && currentDir.equals(disk)) {
        shouldCreateNewEntryLog.set(true);
    }
}

METRICS:
LOC: 4
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 1
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #22000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/persistence/CacheKey.java/getSeqId
Release: 4.2.1

Code:
public long getSeqId() {
    return seqId;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #1000 ==========
Method: ../bookkeeper/hedwig-client/src/main/java/org/apache/hedwig/client/netty/impl/HChannelImpl 2.java/close
Release: 4.0.0

Code:
@Override
public void close() {
    close(false);
}

METRICS:
LOC: 3
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #2000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DataFormats 2.java/setLedgerDirs
Release: 4.0.0

Code:
public Builder setLedgerDirs(String value) {
    if (value == null) {
        throw new NullPointerException();
    }
    bitField0_ |= 0x00000004;
    ledgerDirs_ = value;
    onChanged();
    return this;
}

METRICS:
LOC: 7
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 1
Nesting Depth: 1
Smells: 1
Smell types:
  - AvoidThrowingNullPointerException


========== METHOD #3000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager 2.java/disableLedgerReplication
Release: 4.0.0

Code:
@Override
public void disableLedgerReplication() throws ReplicationException.UnavailableException {
    LOG.debug("disableLedegerReplication()");
    try {
        ZkUtils.createFullPathOptimistic(zkc, basePath + '/' + BookKeeperConstants.DISABLE_NODE, "".getBytes(UTF_8), Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);
        LOG.info("Auto ledger re-replication is disabled!");
    } catch (KeeperException.NodeExistsException ke) {
        LOG.warn("AutoRecovery is already disabled!", ke);
        throw new ReplicationException.UnavailableException("AutoRecovery is already disabled!", ke);
    } catch (KeeperException ke) {
        LOG.error("Exception while stopping auto ledger re-replication", ke);
        throw new ReplicationException.UnavailableException("Exception while stopping auto ledger re-replication", ke);
    } catch (InterruptedException ie) {
        Thread.currentThread().interrupt();
        throw new ReplicationException.UnavailableException("Interrupted while stopping auto ledger re-replication", ie);
    }
}

METRICS:
LOC: 15
Cyclomatic Complexity: 4
Cognitive Complexity: 4
Parameter Count: 0
Nesting Depth: 2
Smells: 0
Smell types:


========== METHOD #4000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal 3.java/getTxnLogId
Release: 4.0.0

Code:
synchronized long getTxnLogId() {
    return txnLogId;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #5000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/persistence/BookkeeperPersistenceManager.java/read
Release: 4.0.0

Code:
protected void read(final InMemoryLedgerRange imlr, final long startSeqId, final long endSeqId) {
    if (imlr.handle == null) {
        bk.asyncOpenLedger(imlr.range.getLedgerId(), DigestType.CRC32, passwd, new SafeAsynBKCallback.OpenCallback() {

            @Override
            public void safeOpenComplete(int rc, LedgerHandle ledgerHandle, Object ctx) {
                if (rc == BKException.Code.OK) {
                    imlr.handle = ledgerHandle;
                    read(imlr, startSeqId, endSeqId);
                    return;
                }
                BKException bke = BKException.create(rc);
                logger.error("Could not open ledger: " + imlr.range.getLedgerId() + " for topic: " + topic);
                request.callback.scanFailed(ctx, new PubSubException.ServiceDownException(bke));
                return;
            }
        }, request.ctx);
        return;
    }
    // ledger handle is not null, we can read from it
    long correctedEndSeqId = Math.min(startSeqId + request.messageLimit - numMessagesRead - 1, endSeqId);
    if (logger.isDebugEnabled()) {
        logger.debug("Issuing a bk read for ledger: " + imlr.handle.getId() + " from entry-id: " + (startSeqId - imlr.startSeqIdIncluded) + " to entry-id: " + (correctedEndSeqId - imlr.startSeqIdIncluded));
    }
    imlr.handle.asyncReadEntries(startSeqId - imlr.startSeqIdIncluded, correctedEndSeqId - imlr.startSeqIdIncluded, new SafeAsynBKCallback.ReadCallback() {

        long expectedEntryId = startSeqId - imlr.startSeqIdIncluded;

        @Override
        public void safeReadComplete(int rc, LedgerHandle lh, Enumeration<LedgerEntry> seq, Object ctx) {
            if (rc != BKException.Code.OK || !seq.hasMoreElements()) {
                BKException bke = BKException.create(rc);
                logger.error("Error while reading from ledger: " + imlr.range.getLedgerId() + " for topic: " + topic.toStringUtf8(), bke);
                request.callback.scanFailed(request.ctx, new PubSubException.ServiceDownException(bke));
                return;
            }
            LedgerEntry entry = null;
            while (seq.hasMoreElements()) {
                entry = seq.nextElement();
                Message message;
                try {
                    message = Message.parseFrom(entry.getEntryInputStream());
                } catch (IOException e) {
                    String msg = "Unreadable message found in ledger: " + imlr.range.getLedgerId() + " for topic: " + topic.toStringUtf8();
                    logger.error(msg, e);
                    request.callback.scanFailed(ctx, new PubSubException.UnexpectedConditionException(msg));
                    return;
                }
                if (logger.isDebugEnabled()) {
                    logger.debug("Read response from ledger: " + lh.getId() + " entry-id: " + entry.getEntryId());
                }
                assert expectedEntryId == entry.getEntryId() : "expectedEntryId (" + expectedEntryId + ") != entry.getEntryId() (" + entry.getEntryId() + ")";
                assert (message.getMsgId().getLocalComponent() - imlr.startSeqIdIncluded) == expectedEntryId;
                expectedEntryId++;
                request.callback.messageScanned(ctx, message);
                numMessagesRead++;
                totalSizeRead += message.getBody().size();
                if (numMessagesRead >= request.messageLimit) {
                    request.callback.scanFinished(ctx, ReasonForFinish.NUM_MESSAGES_LIMIT_EXCEEDED);
                    return;
                }
                if (totalSizeRead >= request.sizeLimit) {
                    request.callback.scanFinished(ctx, ReasonForFinish.SIZE_LIMIT_EXCEEDED);
                    return;
                }
            }
            startReadingFrom(imlr.startSeqIdIncluded + entry.getEntryId() + 1);
        }
    }, request.ctx);
}

METRICS:
LOC: 54
Cyclomatic Complexity: 10
Cognitive Complexity: 11
Parameter Count: 3
Nesting Depth: 3
Smells: 4
Smell types:
  - CognitiveComplexity
  - NPathComplexity
  - LawOfDemeter
  - GuardLogStatement


========== METHOD #6000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/internalGetResult
Release: 4.1.0

Code:
protected org.apache.hedwig.protocol.PubSubProtocol.ConsumeRequest internalGetResult() {
    return result;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #7000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding 2.java/encode
Release: 4.1.0

Code:
@Override
public Object encode(ChannelHandlerContext ctx, Channel channel, Object msg) throws Exception {
    if (!(msg instanceof BookieProtocol.Request)) {
        return msg;
    }
    BookieProtocol.Request r = (BookieProtocol.Request) msg;
    if (r instanceof BookieProtocol.AddRequest) {
        BookieProtocol.AddRequest ar = (BookieProtocol.AddRequest) r;
        int totalHeaderSize = // for the header
        4 + // for the master key
        BookieProtocol.MASTER_KEY_LENGTH;
        ChannelBuffer buf = channel.getConfig().getBufferFactory().getBuffer(totalHeaderSize);
        buf.writeInt(new PacketHeader(r.getProtocolVersion(), r.getOpCode(), r.getFlags()).toInt());
        buf.writeBytes(r.getMasterKey(), 0, BookieProtocol.MASTER_KEY_LENGTH);
        return ChannelBuffers.wrappedBuffer(buf, ar.getData());
    } else {
        assert (r instanceof BookieProtocol.ReadRequest);
        int totalHeaderSize = // for request type
        4 + // for ledgerId
        8 + // for entryId
        8;
        if (r.hasMasterKey()) {
            totalHeaderSize += BookieProtocol.MASTER_KEY_LENGTH;
        }
        ChannelBuffer buf = channel.getConfig().getBufferFactory().getBuffer(totalHeaderSize);
        buf.writeInt(new PacketHeader(r.getProtocolVersion(), r.getOpCode(), r.getFlags()).toInt());
        buf.writeLong(r.getLedgerId());
        buf.writeLong(r.getEntryId());
        if (r.hasMasterKey()) {
            buf.writeBytes(r.getMasterKey(), 0, BookieProtocol.MASTER_KEY_LENGTH);
        }
        return buf;
    }
}

METRICS:
LOC: 29
Cyclomatic Complexity: 5
Cognitive Complexity: 5
Parameter Count: 3
Nesting Depth: 2
Smells: 1
Smell types:
  - LawOfDemeter


========== METHOD #8000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DataFormats 3.java/newBuilder
Release: 4.1.0

Code:
public static Builder newBuilder() {
    return Builder.create();
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #9000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java/processResult
Release: 4.1.0

Code:
@Override
public void processResult(int rc, String path, Object ctx) {
    cb.recoverComplete(rc, ctx);
}

METRICS:
LOC: 3
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 3
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #10000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerCacheImpl 3.java/getLedgerDirForLedger
Release: 4.1.0

Code:
/**
 * Get the ledger directory that the ledger index belongs to.
 *
 * @param fi File info of a ledger
 * @return ledger directory that the ledger belongs to.
 */
private File getLedgerDirForLedger(FileInfo fi) {
    return fi.getLf().getParentFile().getParentFile().getParentFile();
}

METRICS:
LOC: 8
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 1
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #11000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/persistence/ReadAheadCache.java/performRequest
Release: 4.1.0

Code:
/**
 * If for some reason, an outstanding read on a cache stub fails,
 * exception for that key is enqueued by the
 * {@link ReadAheadScanCallback}. To handle this, we simply send error
 * on the callbacks registered for that stub, and delete the entry from
 * the cache
 */
public void performRequest() {
    removeMessageFromCache(cacheKey, exception, // maintainTimeIndex=
    true, // maintainSeqIdIndex=
    true);
}

METRICS:
LOC: 11
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 1
Smell types:
  - MissingOverride


========== METHOD #12000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/writeTo
Release: 4.2.0

Code:
public void writeTo(com.google.protobuf.CodedOutputStream output) throws java.io.IOException {
    getSerializedSize();
    if (((bitField0_ & 0x00000001) == 0x00000001)) {
        output.writeEnum(1, protocolVersion_.getNumber());
    }
    if (((bitField0_ & 0x00000002) == 0x00000002)) {
        output.writeEnum(2, type_.getNumber());
    }
    for (int i = 0; i < triedServers_.size(); i++) {
        output.writeBytes(3, triedServers_.get(i));
    }
    if (((bitField0_ & 0x00000004) == 0x00000004)) {
        output.writeUInt64(4, txnId_);
    }
    if (((bitField0_ & 0x00000008) == 0x00000008)) {
        output.writeBool(5, shouldClaim_);
    }
    if (((bitField0_ & 0x00000010) == 0x00000010)) {
        output.writeBytes(6, topic_);
    }
    if (((bitField0_ & 0x00000020) == 0x00000020)) {
        output.writeMessage(52, publishRequest_);
    }
    if (((bitField0_ & 0x00000040) == 0x00000040)) {
        output.writeMessage(53, subscribeRequest_);
    }
    if (((bitField0_ & 0x00000080) == 0x00000080)) {
        output.writeMessage(54, consumeRequest_);
    }
    if (((bitField0_ & 0x00000100) == 0x00000100)) {
        output.writeMessage(55, unsubscribeRequest_);
    }
    if (((bitField0_ & 0x00000200) == 0x00000200)) {
        output.writeMessage(56, stopDeliveryRequest_);
    }
    if (((bitField0_ & 0x00000400) == 0x00000400)) {
        output.writeMessage(57, startDeliveryRequest_);
    }
    if (((bitField0_ & 0x00000800) == 0x00000800)) {
        output.writeMessage(58, closeSubscriptionRequest_);
    }
    getUnknownFields().writeTo(output);
}

METRICS:
LOC: 29
Cyclomatic Complexity: 14
Cognitive Complexity: 13
Parameter Count: 1
Nesting Depth: 1
Smells: 3
Smell types:
  - CyclomaticComplexity
  - NPathComplexity
  - ForLoopCanBeForeach


========== METHOD #13000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/internalGetFieldAccessorTable
Release: 4.2.0

Code:
protected com.google.protobuf.GeneratedMessage.FieldAccessorTable internalGetFieldAccessorTable() {
    return org.apache.hedwig.protocol.PubSubProtocol.internal_static_Hedwig_ResponseBody_fieldAccessorTable;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #14000 ==========
Method: ../bookkeeper/hedwig-client/src/main/java/org/apache/hedwig/client/netty/HChannelManager.java/stopDelivery
Release: 4.2.0

Code:
/**
 * Stop delivering messages for a given topic subscriber.
 *
 * @param topicSubscriber
 *            Topic Subscriber
 * @throws ClientNotSubscribedException
 *             If the client is not currently subscribed to the topic
 */
public void stopDelivery(TopicSubscriber topicSubscriber) throws ClientNotSubscribedException;

METRICS:
LOC: 9
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 1
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #15000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DataFormats 2.java/getLength
Release: 4.2.0

Code:
long getLength();

METRICS:
LOC: 1
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #16000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DataFormats 3.java/getBookieId
Release: 4.2.0

Code:
public String getBookieId() {
    java.lang.Object ref = bookieId_;
    if (!(ref instanceof String)) {
        String s = ((com.google.protobuf.ByteString) ref).toStringUtf8();
        bookieId_ = s;
        return s;
    } else {
        return (String) ref;
    }
}

METRICS:
LOC: 8
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 0
Nesting Depth: 1
Smells: 1
Smell types:
  - MissingOverride


========== METHOD #17000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RoundRobinDistributionSchedule.java/getWriteSet
Release: 4.2.0

Code:
@Override
public List<Integer> getWriteSet(long entryId) {
    List<Integer> set = new ArrayList<Integer>();
    for (int i = 0; i < this.writeQuorumSize; i++) {
        set.add((int) ((entryId + i) % ensembleSize));
    }
    return set;
}

METRICS:
LOC: 6
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 1
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #18000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Bookie.java/checkEnvironment
Release: 4.2.0

Code:
/**
 * Check that the environment for the bookie is correct.
 * This means that the configuration has stayed the same as the
 * first run and the filesystem structure is up to date.
 */
private void checkEnvironment(ZooKeeper zk) throws BookieException, IOException {
    if (zk == null) {
        // exists only for testing, just make sure directories are correct
        checkDirectoryStructure(journalDirectory);
        for (File dir : ledgerDirsManager.getAllLedgerDirs()) {
            checkDirectoryStructure(dir);
        }
        return;
    }
    try {
        String instanceId = getInstanceId(zk);
        boolean newEnv = false;
        Cookie masterCookie = Cookie.generateCookie(conf);
        if (null != instanceId) {
            masterCookie.setInstanceId(instanceId);
        }
        try {
            Cookie zkCookie = Cookie.readFromZooKeeper(zk, conf);
            masterCookie.verify(zkCookie);
        } catch (KeeperException.NoNodeException nne) {
            newEnv = true;
        }
        List<File> missedCookieDirs = new ArrayList<File>();
        checkDirectoryStructure(journalDirectory);
        // try to read cookie from journal directory
        try {
            Cookie journalCookie = Cookie.readFromDirectory(journalDirectory);
            journalCookie.verify(masterCookie);
        } catch (FileNotFoundException fnf) {
            missedCookieDirs.add(journalDirectory);
        }
        for (File dir : ledgerDirsManager.getAllLedgerDirs()) {
            checkDirectoryStructure(dir);
            try {
                Cookie c = Cookie.readFromDirectory(dir);
                c.verify(masterCookie);
            } catch (FileNotFoundException fnf) {
                missedCookieDirs.add(dir);
            }
        }
        if (!newEnv && missedCookieDirs.size() > 0) {
            LOG.error("Cookie exists in zookeeper, but not in all local directories. " + " Directories missing cookie file are " + missedCookieDirs);
            throw new BookieException.InvalidCookieException();
        }
        if (newEnv) {
            if (missedCookieDirs.size() > 0) {
                LOG.debug("Directories missing cookie file are {}", missedCookieDirs);
                masterCookie.writeToDirectory(journalDirectory);
                for (File dir : ledgerDirsManager.getAllLedgerDirs()) {
                    masterCookie.writeToDirectory(dir);
                }
            }
            masterCookie.writeToZooKeeper(zk, conf);
        }
    } catch (KeeperException ke) {
        LOG.error("Couldn't access cookie in zookeeper", ke);
        throw new BookieException.InvalidCookieException(ke);
    } catch (UnknownHostException uhe) {
        LOG.error("Couldn't check cookies, networking is broken", uhe);
        throw new BookieException.InvalidCookieException(uhe);
    } catch (IOException ioe) {
        LOG.error("Error accessing cookie on disks", ioe);
        throw new BookieException.InvalidCookieException(ioe);
    } catch (InterruptedException ie) {
        LOG.error("Thread interrupted while checking cookies, exiting", ie);
        throw new BookieException.InvalidCookieException(ie);
    }
}

METRICS:
LOC: 58
Cyclomatic Complexity: 16
Cognitive Complexity: 18
Parameter Count: 1
Nesting Depth: 4
Smells: 6
Smell types:
  - CognitiveComplexity
  - CyclomaticComplexity
  - NPathComplexity
  - UseCollectionIsEmpty
  - GuardLogStatement
  - ExceptionAsFlowControl


========== METHOD #19000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/meta/ZkMetadataManagerFactory.java/safeProcessResult
Release: 4.2.0

Code:
@Override
public void safeProcessResult(int rc, String path, Object ctx, byte[] data, Stat stat) {
    if (Code.NONODE.intValue() == rc) {
        callback.operationFinished(ctx, null);
        return;
    }
    if (Code.OK.intValue() != rc) {
        KeeperException e = ZkUtils.logErrorAndCreateZKException("Could not read ownership for topic: " + topic.toStringUtf8(), path, rc);
        callback.operationFailed(ctx, new PubSubException.ServiceDownException(e));
        return;
    }
    HubInfo owner = null;
    try {
        owner = HubInfo.parse(new String(data));
    } catch (HubInfo.InvalidHubInfoException ihie) {
        logger.warn("Failed to parse hub info for topic " + topic.toStringUtf8() + " : ", ihie);
    }
    int version = stat.getVersion();
    callback.operationFinished(ctx, new Versioned<HubInfo>(owner, new ZkVersion(version)));
    return;
}

METRICS:
LOC: 17
Cyclomatic Complexity: 4
Cognitive Complexity: 4
Parameter Count: 5
Nesting Depth: 2
Smells: 1
Smell types:
  - GuardLogStatement


========== METHOD #20000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/topics/MMTopicManager.java/operationFailed
Release: 4.2.0

Code:
@Override
public void operationFailed(Object ctx, PubSubException exception) {
    if (exception instanceof PubSubException.NoTopicOwnerInfoException || exception instanceof PubSubException.BadVersionException) {
        // some one has updated the owner
        logger.info("{} : Some one has claimed topic {} 's owner. Try to read the owner again.", new Object[] { addr, topic.toStringUtf8() });
        read();
        return;
    }
    cb.operationFailed(ctx, new PubSubException.ServiceDownException("Exception when writing owner info to claim ownership of topic " + topic.toStringUtf8() + " : " + exception.getMessage()));
}

METRICS:
LOC: 7
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 2
Nesting Depth: 1
Smells: 2
Smell types:
  - GuardLogStatement
  - UnnecessaryVarargsArrayCreation


========== METHOD #21000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/getPreferences
Release: 4.2.1

Code:
public org.apache.hedwig.protocol.PubSubProtocol.SubscriptionPreferences getPreferences() {
    return preferences_;
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 1
Smell types:
  - MissingOverride


========== METHOD #22000 ==========
Method: ../bookkeeper/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java/parseFrom
Release: 4.2.1

Code:
public static org.apache.hedwig.protocol.PubSubProtocol.LedgerRanges parseFrom(com.google.protobuf.ByteString data) throws com.google.protobuf.InvalidProtocolBufferException {
    return newBuilder().mergeFrom(data).buildParsed();
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 1
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #23000 ==========
Method: ../bookkeeper/hedwig-client-jms/src/main/java/org/apache/hedwig/jms/spi/HedwigMessagingSessionFacade.java/start
Release: 4.2.1

Code:
@Override
public void start() throws JMSException {
    if (!connection.isInStartMode())
        throw new JMSException("Connection not yet started ?");
    if (logger.isTraceEnabled())
        logger.trace("Creating HedwigClient");
    // create only if there is need for it.
    if (null == this.hedwigClient) {
        this.hedwigClient = new HedwigClient(connection.getHedwigClientConfig());
        resetStartInfoSet();
    }
    this.stopped = false;
}

METRICS:
LOC: 10
Cyclomatic Complexity: 4
Cognitive Complexity: 3
Parameter Count: 0
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #24000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DataFormats.java/getSerializedSize
Release: 4.2.1

Code:
public int getSerializedSize() {
    int size = memoizedSerializedSize;
    if (size != -1)
        return size;
    size = 0;
    {
        int dataSize = 0;
        for (int i = 0; i < ensembleMember_.size(); i++) {
            dataSize += com.google.protobuf.CodedOutputStream.computeBytesSizeNoTag(ensembleMember_.getByteString(i));
        }
        size += dataSize;
        size += 1 * getEnsembleMemberList().size();
    }
    if (((bitField0_ & 0x00000001) == 0x00000001)) {
        size += com.google.protobuf.CodedOutputStream.computeInt64Size(2, firstEntryId_);
    }
    size += getUnknownFields().getSerializedSize();
    memoizedSerializedSize = size;
    return size;
}

METRICS:
LOC: 15
Cyclomatic Complexity: 4
Cognitive Complexity: 3
Parameter Count: 0
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #25000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DataFormats 2.java/getDescriptorForType
Release: 4.2.1

Code:
public com.google.protobuf.Descriptors.Descriptor getDescriptorForType() {
    return org.apache.bookkeeper.proto.DataFormats.CookieFormat.getDescriptor();
}

METRICS:
LOC: 2
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #26000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManagerFactory 3.java/initialize
Release: 4.2.1

Code:
@Override
public LedgerManagerFactory initialize(final AbstractConfiguration conf, final ZooKeeper zk, final int factoryVersion) throws IOException {
    if (CUR_VERSION != factoryVersion) {
        throw new IOException("Incompatible layout version found : " + factoryVersion);
    }
    this.conf = conf;
    this.zk = zk;
    return this;
}

METRICS:
LOC: 7
Cyclomatic Complexity: 2
Cognitive Complexity: 1
Parameter Count: 3
Nesting Depth: 1
Smells: 0
Smell types:


========== METHOD #27000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetaStore 3.java/getVersion
Release: 4.2.1

Code:
@Override
public int getVersion() {
    return CUR_VERSION;
}

METRICS:
LOC: 3
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #28000 ==========
Method: ../bookkeeper/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerCacheImpl 3.java/getEntriesPerPage
Release: 4.2.1

Code:
/**
 * @return entries per page used in ledger cache
 */
public int getEntriesPerPage() {
    return entriesPerPage;
}

METRICS:
LOC: 5
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 0
Nesting Depth: 0
Smells: 0
Smell types:


========== METHOD #29000 ==========
Method: ../bookkeeper/hedwig-server/src/main/java/org/apache/hedwig/server/subscriptions/AbstractSubscriptionManager.java/operationFailed
Release: 4.2.1

Code:
@Override
public void operationFailed(Object ctx, PubSubException exception) {
    cb.operationFailed(ctx, exception);
}

METRICS:
LOC: 3
Cyclomatic Complexity: 1
Cognitive Complexity: 0
Parameter Count: 2
Nesting Depth: 0
Smells: 0
Smell types:


